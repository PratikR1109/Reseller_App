<!DOCTYPE html>
<html lang="en">

<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<title>sunfnl - <%if(data._id){%>Edit<%}else{%>Add<%}%> Catalog</title>
<!-- Tell the browser to be responsive to screen width -->

<meta name="viewport" content="width=device-width, initial-scale=1">
<!-- v4.1.3 -->
<link rel="stylesheet" href="<%BaseUrl%>/bootstrap/css/bootstrap.min.css">

<!-- Google Font -->
<link href="https://fonts.googleapis.com/css?family=Poppins:300,400,500,600,700" rel="stylesheet">

<!-- Theme style -->
<link rel="stylesheet" href="<%BaseUrl%>/css/style.css">
<link rel="stylesheet" href="<%BaseUrl%>/css/font-awesome/css/font-awesome.min.css">
<link rel="stylesheet" href="<%BaseUrl%>/css/et-line-font/et-line-font.css">
<link rel="stylesheet" href="<%BaseUrl%>/css/themify-icons/themify-icons.css">
<link rel="stylesheet" href="<%BaseUrl%>/css/simple-lineicon/simple-line-icons.css">
<link rel="stylesheet" href="<%BaseUrl%>/css/skins/_all-skins.min.css?v=1">
<!-- DataTables -->
<link rel="stylesheet" href="<%BaseUrl%>/plugins/datatables/css/dataTables.bootstrap.min.css">
<!-- dropify -->
<link rel="stylesheet" href="<%BaseUrl%>/plugins/dropify/dropify.min.css">
<!-- bootstrap-switch -->
<link rel="stylesheet" href="<%BaseUrl%>/plugins/select2/dist/css/select2.min.css">
<style type="text/css">
    .select2-container .select2-selection--single{
        height: 42px !important;
    }
    .select2-container--default .select2-selection--single{
        border: 1px solid #ddd !important;
        color: #ddd !important;
    }
    .select2-container--default .select2-selection--single .select2-selection__rendered{
        line-height: 30px !important;
        font-size: 16px !important;
        margin-left: -8px !important;
    }
    .select2-selection__rendered{
        padding-left: -3px !important;
    }
    .select2-container--default .select2-selection--single .select2-selection__arrow{
        top: 5px !important;
    }
</style>

</head>
<body class="sidebar-mini skin-black-light">
<div class="wrapper boxed-wrapper">
  <header class="main-header"> 
    <!-- Logo --> 
    <a href="javascript:;" class="logo blue-bg"> 
    <!-- mini logo for sidebar mini 50x50 pixels --> 
    <span class="logo-mini"><img src="<%BaseUrl%>/img/sss.png" alt=""></span> 
    <!-- logo for regular state and mobile devices --> 
    <span class="logo-lg"><img src="<%BaseUrl%>/img/sun.png" alt=""></span> </a> 
    <!-- Header Navbar -->
    <nav class="navbar blue-bg navbar-static-top"> 
      <!-- Sidebar toggle button-->
      <ul class="nav navbar-nav pull-left">
        <li><a class="sidebar-toggle" data-toggle="push-menu" href="#"></a> </li>
      </ul>
    </nav>
  </header>
  <!-- Left side column. contains the logo and sidebar -->
  <% include left_layout.html %>
  
  <!-- Content Wrapper. Contains page content -->
  <div class="content-wrapper"> 
    <!-- Content Header (Page header) -->
   <div class="content-header sty-one">
      <h1><%if(data._id){%>Edit<%}else{%>Add<%}%> Catalog</h1>
      <ol class="breadcrumb">
        <li><a href="<%BaseUrl%>/dashboard">Dashboard</a></li>
        <li><i class="fa fa-angle-right"></i> <%if(data._id){%>Edit<%}else{%>Add<%}%> Catalog </li>
      </ol>
    </div>
    

    <div class="content">
        <div class="row">
            <div class="col-lg-12">
              <div class="card ">
                <div class="card-header bg-blue">
                  <h5 class="text-white m-b-0"><%if(data._id){%>Edit<%}else{%>Add<%}%> Catalog</h5>
                </div>
                <div class="card-body">
                  
                  <form id="addcatalog" action="" method="post" enctype="multipart/form-data">
                    <input type="hidden" name="catalogId" value="<%if(data._id){%><%=data._id%><%}else{%><%}%>">
                  <div class="row"> 
                    <div class="col-md-9">
                      <div class="form-group has-feedback">
                        <label class="control-label">Select Vendor *</label>
                          <select id="vendorlist" name="vendorId" class="select2 form-control custom-select" style="width: 100%; height:36px;" required>
                              <option>Select Vendor</option>
                          </select>
                      </div>
                    </div>
                    <div class="col-md-3">
                      <div class="form-group has-feedback">
                        <label class="control-label">Add Vendor</label>
                          <a href="<%=BaseUrl%>/addvendor" class="btn btn-primary btn-block">Create New Vendor</a>
                        </div>
                    </div>
                    <div class="col-md-9">
                      <div class="form-group has-feedback">
                        <label class="control-label">Category *</label>
                        <%if(data._id){%>
                          <input class="form-control" type="text" name="categoriesId" id="categoriesId" value="" readonly>
                        <%}else{%>
                          <select id="category" name="categoriesId" class="select2 form-control custom-select" style="width: 100%; height:36px;" required>
                              <option>Select Category</option>
                          </select>
                        <%}%>
                      </div>
                    </div>
                    <div class="col-md-3">
                      <div class="form-group has-feedback">
                        <label class="control-label">Add Category</label>
                          <a href="<%=BaseUrl%>/addcatagories" class="btn btn-primary btn-block">Create New Category</a>
                        </div>
                    </div> 
                    <div class="col-md-6">
                      <div class="form-group has-feedback">
                        <label class="control-label">Name *</label>
                        <%if(data._id){%>
                          <input class="form-control" id="name" name="name" placeholder="Add Name" value="<%if(data.name){%><%=data.name%><%}else{%><%}%>" type="text" readonly>
                        <%}else{%>
                          <input class="form-control" id="name" name="name" placeholder="Add Name" value="<%if(data.name){%><%=data.name%><%}else{%><%}%>" type="text" required>
                        <%}%>
                      </div>
                    </div> 
                    <div class="col-md-6">
                      <div class="form-group has-feedback">
                        <label class="control-label">Price *</label>
                        <input class="form-control" id="price" name="price" placeholder="Add Price" value="<%if(data.price){%><%=data.price%><%}else{%><%}%>" type="number" required>
                      </div>
                    </div> 
                    <div class="col-md-12">
                      <div class="form-group has-feedback">
                        <label class="control-label">Description *</label>
                        <textarea class="form-control" id="description" name="description" rows="3" placeholder="Description" required><%if(data.description){%><%=data.description%><%}else{%><%}%></textarea>
                      </div>
                    </div>
                    <div class="col-md-12">
                      <div class="form-group has-feedback">
                        <label class="control-label">Note's </label>
                        <textarea class="form-control"  rows="3" placeholder="Note's" name="notes" id="notes"><%if(data.notes){%><%=data.notes%><%}else{%><%}%></textarea>
                      </div>
                    </div> 
                    <div class="col-md-12">
                      <div class="form-group has-feedback">
                        <label class="control-label">Category Image </label>
                        <input type="file" id="input-file-now" name="catalog_img" class="dropify" data-allowed-file-extensions="png jpg jpeg PNG JPG JPEG" data-default-file="<%if(data.catalog_image){%><%=data.catalog_image%><%}else{}%>"/>
                        <%if(error){%>
                        <label style="color: red; font-weight: 500;"><%=msg%></label>
                        <%}%>
                      </div>
                    </div>
                    <div class="col-md-12">
                      <button type="submit" class="btn btn-success">Submit</button>
                    </div>
                  </div>
                  </form>
               
                </div>
              </div>
            </div>
        </div> 
    </div>


  </div>
  <!-- /.content-wrapper -->
  <footer class="main-footer">
    <div class="pull-right hidden-xs">Version 1.0</div>
    Copyright © 2018 SunFashion. All rights reserved.</footer>
</div>
<!-- ./wrapper --> 

<!-- jQuery 3 --> 
<script src="<%BaseUrl%>/js/jquery.min.js"></script>  
<script src="<%BaseUrl%>/bootstrap/js/bootstrap.min.js"></script> 

<!-- template --> 
<script src="<%BaseUrl%>/js/bizadmin.js"></script> 

<!-- Jquery Sparklines --> 
<script src="<%BaseUrl%>/plugins/jquery-sparklines/jquery.sparkline.min.js"></script> 
<script src="<%BaseUrl%>/plugins/jquery-sparklines/sparkline-int.js"></script> 
<!-- DataTable --> 
<script src="<%BaseUrl%>/plugins/datatables/jquery.dataTables.min.js"></script> 
<script src="<%BaseUrl%>/plugins/datatables/dataTables.bootstrap.min.js"></script> 
<script>
  $(function () {
    $('#example1').DataTable()
    $('#example2').DataTable({
      'paging'      : true,
      'lengthChange': false,
      'searching'   : false,
      'ordering'    : true,
      'info'        : true,
      'autoWidth'   : false
    })
  })
</script>
<script src="<%BaseUrl%>/plugins/table-expo/filesaver.min.js"></script>
<script src="<%BaseUrl%>/plugins/table-expo/xls.core.min.js"></script>
<script src="<%BaseUrl%>/plugins/table-expo/tableexport.js"></script>
<script>
$("table").tableExport({formats: ["xlsx","xls", "csv", "txt"],    });
</script>

<!-- dropify --> 
<script src="<%BaseUrl%>/plugins/dropify/dropify.min.js"></script> 
<script>
  $(document).ready(function(){
  // Basic
  $('.dropify').dropify();

  // Translated
   $('.dropify-fr').dropify({
                    messages: {
                        default: 'Glissez-déposez un fichier ici ou cliquez',
                        replace: 'Glissez-déposez un fichier ou cliquez pour remplacer',
                        remove:  'Supprimer',
                        error:   'Désolé, le fichier trop volumineux'
                    }
                });

                // Used events
                var drEvent = $('#input-file-events').dropify();

                drEvent.on('dropify.beforeClear', function(event, element){
                    return confirm("Do you really want to delete \"" + element.file.name + "\" ?");
                });

                drEvent.on('dropify.afterClear', function(event, element){
                    alert('File deleted');
                });

                drEvent.on('dropify.errors', function(event, element){
                    console.log('Has Errors');
                });

                var drDestroy = $('#input-file-to-destroy').dropify();
                drDestroy = drDestroy.data('dropify')
                $('#toggleDropify').on('click', function(e){
                    e.preventDefault();
                    if (drDestroy.isDropified()) {
                        drDestroy.destroy();
                    } else {
                        drDestroy.init();
                    }
                })
    });
</script>


<script src="<%BaseUrl%>/plugins/select2/dist/js/select2.full.min.js"></script>
<script type="text/javascript" src="http://cdnjs.cloudflare.com/ajax/libs/sweetalert/2.1.2/sweetalert.min.js"></script>
<script>
    jQuery(document).ready(function() {
        // Switchery
        var elems = Array.prototype.slice.call(document.querySelectorAll('.js-switch'));
        $('.js-switch').each(function() {
            new Switchery($(this)[0], $(this).data());
        });
        // For select 2
        $(".select2").select2();
      
    
        $(".ajax").select2({
            ajax: {
                url: "https://api.github.com/search/repositories",
                dataType: 'json',
                delay: 250,
                data: function(params) {
                    return {
                        q: params.term, // search term
                        page: params.page
                    };
                },
                processResults: function(data, params) {
                    // parse the results into the format expected by Select2
                    // since we are using custom formatting functions we do not need to
                    // alter the remote JSON data, except to indicate that infinite
                    // scrolling can be used
                    params.page = params.page || 1;
                    return {
                        results: data.items,
                        pagination: {
                            more: (params.page * 30) < data.total_count
                        }
                    };
                },
                cache: true
            },
            escapeMarkup: function(markup) {
                return markup;
            }, // let our custom formatter work
            minimumInputLength: 1,
            // templateResult: formatRepo, // omitted for brevity, see the source of this page
            //templateSelection: formatRepoSelection // omitted for brevity, see the source of this page
        });

        
    });
</script>
<script>
    $.ajax(
        {
        url: "<%BaseUrl%>/api/categories",
        type: "GET",
        dataType: "json"                    
    }).done(function(response) {
      console.log("response :::::::: ", response);
      var i;
      var categoryId = "<%if(data.categoriesId){%><%=data.categoriesId%><%}else{%><%}%>";
      for (i = 0; i < response.length; i++) {
        if(categoryId == response[i].id){
          $('#categoriesId').val(response[i].name);
          var category='<option value="'+response[i].id+'" selected>'+response[i].name+'</option>' 
        }else{
          var category='<option value="'+response[i].id+'">'+response[i].name+'</option>' 
        }
      $('#category').append(category);
    }
  })
    $.ajax(
          {
          url: "<%BaseUrl%>/api/vendors",
          type: "GET",
          dataType: "json"                    
      }).done(function(response) {
        console.log("response :::::::: ", response);
        var i;
        var vendorId = "<%if(data.vendorId){%><%=data.vendorId%><%}else{%><%}%>";
        for (i = 0; i < response.length; i++) {
          if(vendorId == response[i]._id){
            var category='<option value="'+response[i]._id+'" selected>'+response[i].name+'</option>' 
          }else{
            var category='<option value="'+response[i]._id+'">'+response[i].name+'</option>' 
          }
        $('#vendorlist').append(category);
      }
    })
</script>
</body>
</html>
